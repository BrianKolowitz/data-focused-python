<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>01.a - Cleaning and Transforming Data - Data Focused Python</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-139655036-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-139655036-1'); </script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>01.a - Cleaning and Transforming Data | Data Focused Python</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="01.a - Cleaning and Transforming Data" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201/01.a%20-%20Cleaning%20and%20Transforming%20Data.html" /> <meta property="og:url" content="http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201/01.a%20-%20Cleaning%20and%20Transforming%20Data.html" /> <meta property="og:site_name" content="Data Focused Python" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="01.a - Cleaning and Transforming Data" /> <script type="application/ld+json"> {"headline":"01.a - Cleaning and Transforming Data","url":"http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201/01.a%20-%20Cleaning%20and%20Transforming%20Data.html","@type":"WebPage","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Data Focused Python </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Data Focused Python</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures" class="nav-list-link">Lectures</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2001%20-%20Getting%20Started.html" class="nav-list-link">Topic 01 - Getting Started</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2001%20-%20Getting%20Started/01%20-%20Getting%20Started.html" class="nav-list-link">01 - Getting Started</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2001%20-%20Getting%20Started/02%20-%20Running%20Python.html" class="nav-list-link">02 - Running Python</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2001%20-%20Getting%20Started/03%20-%20Your%20First%20Python%20Program.html" class="nav-list-link">03 - Your First Python Program</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2001%20-%20Getting%20Started/04%20-%20Python%20Modules%20and%20Packages.html" class="nav-list-link">04 - Python Modules and Packages</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2001%20-%20Getting%20Started/05%20-%20Start%20a%20process%20in%20Python.html" class="nav-list-link">05 - Start a process in Python</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2001%20-%20Getting%20Started/06.a%20-%20Writing%20Terminal%20Application.html" class="nav-list-link">06.a - Writing Terminal Application</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2001%20-%20Getting%20Started/06.b%20-%20Argparse.html" class="nav-list-link">06.b - Argparse</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2002%20-%20Python%20basics.html" class="nav-list-link">Topic 02 - Python basics</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2002%20-%20Python%20basics/01%20-%20Decision%20Structures%20and%20Boolean%20Logic.html" class="nav-list-link">01 - Decision Structures and Boolean Logic</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2002%20-%20Python%20basics/02%20-%20Python%20Tuples.html" class="nav-list-link">02 - Python Tuples</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2002%20-%20Python%20basics/03%20-%20Loops.html" class="nav-list-link">03 - Loops</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2002%20-%20Python%20basics/04%20-%20Python%20Functions.html" class="nav-list-link">04 - Python Functions</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2003%20-%20Generating%20Data.html" class="nav-list-link">Topic 03 - Generating Data</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2003%20-%20Generating%20Data/01%20-%20Generating%20Fake%20Data.html" class="nav-list-link">01 - Generating Fake Data</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2003%20-%20Generating%20Data/02%20-%20Using%20Faker.html" class="nav-list-link">02 - Using Faker</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2003%20-%20Generating%20Data/03%20-%20Generating%20Synthetic%20Healthcare%20Data.html" class="nav-list-link">03 - Generating Synthetic Healthcare Data</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2003%20-%20Generating%20Data/04%20-%20Using%20Synthea.html" class="nav-list-link">04 - Using Synthea</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2003%20-%20Generating%20Data/05%20-%20Generating%20Other%20Synthetic%20Data.html" class="nav-list-link">05 - Generating Other Synthetic Data</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code.html" class="nav-list-link">Topic 04 - Writing Testable Code</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code/01%20-%20Python%20Code%20Quality%20Tools%20and%20Best%20Practices.html" class="nav-list-link">01 - Python Code Quality Tools and Best Practices</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code/02%20-%20Python%20Testing.html" class="nav-list-link">02 - Python Testing</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code/03%20-%20Getting%20Started%20With%20Testing%20in%20Python.html" class="nav-list-link">03 - Getting Started With Testing in Python</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code/04-%20Choosing%20a%20Test%20Runner.html" class="nav-list-link">04- Choosing a Test Runner</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code/05%20-%20Writing%20Your%20First%20Test.html" class="nav-list-link">05 - Writing Your First Test</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code/06%20-%20Writing%20Integration%20Tests.html" class="nav-list-link">06 - Writing Integration Tests</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code/07%20-%20Testing%20in%20Multiple%20Environments.html" class="nav-list-link">07 - Testing in Multiple Environments</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code/08%20-%20Introducing%20Linters%20Into%20Your%20Application.html" class="nav-list-link">08 - Introducing Linters Into Your Application</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code/09%20-%20Testing%20for%20Performance%20Degradation%20Between%20Changes.html" class="nav-list-link">09 - Testing for Performance Degradation Between Changes</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2004%20-%20Writing%20Testable%20Code/10%20-%20Testing%20for%20Security%20Flaws%20in%20Your%20Application.html" class="nav-list-link">10 - Testing for Security Flaws in Your Application</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2005%20-%20Processing%20files.html" class="nav-list-link">Topic 05 - Processing files</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2005%20-%20Processing%20files/01.a%20-%20File%20Processing.html" class="nav-list-link">01.a - File Processing</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2005%20-%20Processing%20files/01.b%20-%20CSV%20Files.html" class="nav-list-link">01.b - CSV Files</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2005%20-%20Processing%20files/01.c%20-%20JSON%20Files.html" class="nav-list-link">01.c - JSON Files</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2005%20-%20Processing%20files/01.d%20-%20XML%20Files.html" class="nav-list-link">01.d - XML Files</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2005%20-%20Processing%20files/03%20-%20Using%20fhirclient%20to%20parse%20Healthcare%20Data.html" class="nav-list-link">03 - Using fhirclient to parse Healthcare Data</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2005%20-%20Processing%20files/04%20-%20Reading%20synthea%20data.html" class="nav-list-link">04 - Reading synthea data</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2006%20-%20Comprehensions%20and%20Generators.html" class="nav-list-link">Topic 06 - Comprehensions and Generators</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2006%20-%20Comprehensions%20and%20Generators/02%20-%20Lists%20and%20List%20Comprehensions.html" class="nav-list-link">02 - Lists and List Comprehensions</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2006%20-%20Comprehensions%20and%20Generators/03%20-%20Sets%20and%20Set%20Comprehensions.html" class="nav-list-link">03 - Sets and Set Comprehensions</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2006%20-%20Comprehensions%20and%20Generators/04.a%20-%20Dictionaries.html" class="nav-list-link">04.a - Dictionaries</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2006%20-%20Comprehensions%20and%20Generators/04.b%20-%20Dictionary%20Comprehensions.html" class="nav-list-link">04.b - Dictionary Comprehensions</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2006%20-%20Comprehensions%20and%20Generators/05%20-%20Python%20Generators.html" class="nav-list-link">05 - Python Generators</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2007%20-%20Classes.html" class="nav-list-link">Topic 07 - Classes</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2007%20-%20Classes/01%20-%20Python%20Classes.html" class="nav-list-link">01 - Python Classes</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2008%20-%20Making%20Web%20Requests.html" class="nav-list-link">Topic 08 - Making Web Requests</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2008%20-%20Making%20Web%20Requests/03%20-%20Using%20requests%20to%20fetch%20Healthcare%20Data.html" class="nav-list-link">03 - Using requests to fetch Healthcare Data</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2008%20-%20Making%20Web%20Requests/05%20-%20Getting%20Data%20from%20Web%20APIs.html" class="nav-list-link">05 - Getting Data from Web APIs</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2009%20-%20Interfacing%20with%20Databases.html" class="nav-list-link">Topic 09 - Interfacing with Databases</a><ul class="nav-list"></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201.html" class="nav-list-link">Topic 10 - Data Processing and Visualization Part 1</a><ul class="nav-list"><li class="nav-list-item active"> <a href="http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201/01.a%20-%20Cleaning%20and%20Transforming%20Data.html" class="nav-list-link active">01.a - Cleaning and Transforming Data</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201/01.b%20-%20Grouping%20Data.html" class="nav-list-link">01.b - Grouping Data</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201/01.c%20-%20Descriptive%20Statistics.html" class="nav-list-link">01.c - Descriptive Statistics</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201/02%20-%20Basic%20Medical%20Data%20Visualization.html" class="nav-list-link">02 - Basic Medical Data Visualization</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201/03.a%20-%20NumPy%20Introduction.html" class="nav-list-link">03.a - NumPy Introduction</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201/03.b%20-%20NumPy%20Data%20analysis.html" class="nav-list-link">03.b - NumPy Data analysis</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2011%20-%20Data%20Processing%20and%20Visualization%20Part%202.html" class="nav-list-link">Topic 11 - Data Processing and Visualization Part 2</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2011%20-%20Data%20Processing%20and%20Visualization%20Part%202/00%20-%20Additional%20Links.html" class="nav-list-link">00 - Additional Links</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2011%20-%20Data%20Processing%20and%20Visualization%20Part%202/01%20-%20Pandas%20Introduction.html" class="nav-list-link">01 - Pandas Introduction</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2011%20-%20Data%20Processing%20and%20Visualization%20Part%202/02.a%20-%20Pandas%20Data%20analysis%20Part%201.html" class="nav-list-link">02.a - Pandas Data analysis Part 1</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2011%20-%20Data%20Processing%20and%20Visualization%20Part%202/02.b%20-%20Pandas%20Data%20analysis%20Part%202.html" class="nav-list-link">02.b - Pandas Data analysis Part 2</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2011%20-%20Data%20Processing%20and%20Visualization%20Part%202/03%20-%20Matplotlib%20Tutorial%20Python%20Plotting.html" class="nav-list-link">03 - Matplotlib Tutorial Python Plotting</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2011%20-%20Data%20Processing%20and%20Visualization%20Part%202/04%20-%20The%20Ultimate%20Python%20Seaborn%20Tutorial.html" class="nav-list-link">04 - The Ultimate Python Seaborn Tutorial</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/lectures/Topic%2012%20-%20Web%20Scraping.html" class="nav-list-link">Topic 12 - Web Scraping</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2012%20-%20Web%20Scraping/01.%20Introduction%20to%20Web%20Scraping.html" class="nav-list-link">01. Introduction to Web Scraping</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2012%20-%20Web%20Scraping/02.%20CSS%20Selectors.html" class="nav-list-link">02. CSS Selectors</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2012%20-%20Web%20Scraping/03.a%20Web%20Scraping%20with%20Beautiful%20Soup.html" class="nav-list-link">03.a Web Scraping with Beautiful Soup</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2012%20-%20Web%20Scraping/03.b%20Web%20Scraping%20Using%20Selenium.html" class="nav-list-link">03.b Web Scraping Using Selenium</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2012%20-%20Web%20Scraping/03.c%20Web%20scraping%20with%20Scrapy.html" class="nav-list-link">03.c Web scraping with Scrapy</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2012%20-%20Web%20Scraping/04.a%20-%20More%20Web%20Scraping%20with%20BeautifulSoup.html" class="nav-list-link">04.a - More Web Scraping with BeautifulSoup</a> </li><li class="nav-list-item "> <a href="http://localhost:4000/lectures/Topic%2012%20-%20Web%20Scraping/04.b%20-%20Even%20More%20Web%20Scraping%20with%20BeautifulSoup.html" class="nav-list-link">04.b - Even More Web Scraping with BeautifulSoup</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/resources" class="nav-list-link">Resources</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/lectures">Lectures</a></li> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/lectures/Topic%2010%20-%20Data%20Processing%20and%20Visualization%20Part%201.html">Topic 10 - Data Processing and Visualization Part 1</a></li> <li class="breadcrumb-nav-list-item"><span>01.a - Cleaning and Transforming Data</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'../data/csv/patients.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="p">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">header</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">reader</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['Id', 'BIRTHDATE', 'DEATHDATE', 'SSN', 'DRIVERS', 'PASSPORT', 'PREFIX', 'FIRST', 'LAST', 'SUFFIX', 'MAIDEN', 'MARITAL', 'RACE', 'ETHNICITY', 'GENDER', 'BIRTHPLACE', 'ADDRESS', 'CITY', 'STATE', 'ZIP']
['3287bb9c-e395-4146-8dd5-1fc3d887d220', '2015-07-12', '', '999-82-9751', '', '', '', 'Victor265', 'Kilback373', '', '', '', 'white', 'polish', 'M', 'Newton  Massachusetts  US', '657 Heathcote Divide', 'Fitchburg', 'Massachusetts', '01420']
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">dateutil</span> <span class="kn">import</span> <span class="n">parser</span>

<span class="k">def</span> <span class="nf">get_age</span><span class="p">(</span><span class="n">birth_date</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">birth_date</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">birth_date</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">birth_date</span><span class="p">).</span><span class="n">date</span><span class="p">()</span>

    <span class="n">age</span> <span class="o">=</span> <span class="p">(</span><span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">()</span>  <span class="o">-</span> <span class="n">birth_date</span><span class="p">)</span> <span class="o">//</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">age</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">date</span><span class="p">.</span><span class="n">today</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>datetime.date(2021, 10, 21)
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>datetime.datetime(2021, 10, 21, 11, 4, 20, 310225)
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">get_age</span><span class="p">(</span><span class="s">'2011-09-10'</span><span class="p">))</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">get_age</span><span class="p">(</span><span class="s">'2014-01-10'</span><span class="p">))</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>7
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ages</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_age</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">ages</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[6, 18, 13, 17, 8, 9, 55, 84, 14, 20, 53, 23, 18, 64, 11, 39, 34, 5, 82, 19, 18, 15, 26, 28, 29, 8, 71, 32, 82, 41, 51, 17, 40, 53, 60, 65, 11, 21, 32, 52, 3, 52, 82, 30, 69, 24, 99, 12, 51, 99, 27, 76, 78, 29, 16, 69, 34, 78, 58, 76, 99, 65, 70, 60, 50, 32, 4, 78, 65, 48, 3, 66, 77, 99, 25, 18, 47, 79, 99, 32, 10, 74, 61, 99, 62, 59, 67, 2, 50, 99, 3, 70, 61, 62, 43, 18, 71, 29, 99, 52, 71, 26, 28, 56, 32, 69, 23, 31, 46, 99, 106, 30, 21, 67, 67, 106, 99, 106, 99, 106, 106, 99, 106, 99, 99, 99, 99, 90, 90]
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">patients</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="s">'birth_date'</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">'age'</span><span class="p">:</span> <span class="n">get_age</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span> <span class="p">]</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">patients</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[{'age': 6, 'birth_date': '2015-07-12'},
 {'age': 18, 'birth_date': '2003-04-15'},
 {'age': 13, 'birth_date': '2008-06-26'},
 {'age': 17, 'birth_date': '2004-06-22'},
 {'age': 8, 'birth_date': '2012-12-12'},
 {'age': 9, 'birth_date': '2012-10-04'},
 {'age': 55, 'birth_date': '1966-10-02'},
 {'age': 84, 'birth_date': '1937-04-18'},
 {'age': 14, 'birth_date': '2007-01-01'},
 {'age': 20, 'birth_date': '2001-09-12'},
 {'age': 53, 'birth_date': '1967-11-05'},
 {'age': 23, 'birth_date': '1998-05-27'},
 {'age': 18, 'birth_date': '2003-06-22'},
 {'age': 64, 'birth_date': '1957-02-03'},
 {'age': 11, 'birth_date': '2009-12-15'},
 {'age': 39, 'birth_date': '1981-11-24'},
 {'age': 34, 'birth_date': '1987-04-23'},
 {'age': 5, 'birth_date': '2016-02-26'},
 {'age': 82, 'birth_date': '1939-05-17'},
 {'age': 19, 'birth_date': '2002-05-04'},
 {'age': 18, 'birth_date': '2003-07-13'},
 {'age': 15, 'birth_date': '2006-09-05'},
 {'age': 26, 'birth_date': '1995-04-13'},
 {'age': 28, 'birth_date': '1993-08-19'},
 {'age': 29, 'birth_date': '1992-02-09'},
 {'age': 8, 'birth_date': '2013-09-10'},
 {'age': 71, 'birth_date': '1950-02-06'},
 {'age': 32, 'birth_date': '1989-05-19'},
 {'age': 82, 'birth_date': '1939-05-17'},
 {'age': 41, 'birth_date': '1980-08-01'},
 {'age': 51, 'birth_date': '1970-10-17'},
 {'age': 17, 'birth_date': '2004-09-02'},
 {'age': 40, 'birth_date': '1981-09-17'},
 {'age': 53, 'birth_date': '1967-11-06'},
 {'age': 60, 'birth_date': '1961-07-15'},
 {'age': 65, 'birth_date': '1956-04-05'},
 {'age': 11, 'birth_date': '2010-04-02'},
 {'age': 21, 'birth_date': '2000-09-13'},
 {'age': 32, 'birth_date': '1989-04-14'},
 {'age': 52, 'birth_date': '1969-08-30'},
 {'age': 3, 'birth_date': '2018-02-15'},
 {'age': 52, 'birth_date': '1968-11-10'},
 {'age': 82, 'birth_date': '1939-05-17'},
 {'age': 30, 'birth_date': '1991-04-14'},
 {'age': 69, 'birth_date': '1951-12-13'},
 {'age': 24, 'birth_date': '1997-09-25'},
 {'age': 99, 'birth_date': '1922-04-03'},
 {'age': 12, 'birth_date': '2009-06-25'},
 {'age': 51, 'birth_date': '1970-01-22'},
 {'age': 99, 'birth_date': '1922-04-03'},
 {'age': 27, 'birth_date': '1994-10-02'},
 {'age': 76, 'birth_date': '1945-05-24'},
 {'age': 78, 'birth_date': '1943-02-09'},
 {'age': 29, 'birth_date': '1992-01-30'},
 {'age': 16, 'birth_date': '2004-11-05'},
 {'age': 69, 'birth_date': '1951-12-13'},
 {'age': 34, 'birth_date': '1987-04-26'},
 {'age': 78, 'birth_date': '1943-02-09'},
 {'age': 58, 'birth_date': '1963-03-09'},
 {'age': 76, 'birth_date': '1945-05-24'},
 {'age': 99, 'birth_date': '1922-04-03'},
 {'age': 65, 'birth_date': '1955-11-30'},
 {'age': 70, 'birth_date': '1950-12-18'},
 {'age': 60, 'birth_date': '1961-05-19'},
 {'age': 50, 'birth_date': '1971-07-29'},
 {'age': 32, 'birth_date': '1988-11-14'},
 {'age': 4, 'birth_date': '2017-05-08'},
 {'age': 78, 'birth_date': '1943-02-09'},
 {'age': 65, 'birth_date': '1955-11-30'},
 {'age': 48, 'birth_date': '1973-09-21'},
 {'age': 3, 'birth_date': '2018-03-25'},
 {'age': 66, 'birth_date': '1955-03-13'},
 {'age': 77, 'birth_date': '1944-05-19'},
 {'age': 99, 'birth_date': '1922-04-03'},
 {'age': 25, 'birth_date': '1996-09-26'},
 {'age': 18, 'birth_date': '2002-11-08'},
 {'age': 47, 'birth_date': '1974-11-01'},
 {'age': 79, 'birth_date': '1942-06-19'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 32, 'birth_date': '1989-07-17'},
 {'age': 10, 'birth_date': '2011-10-02'},
 {'age': 74, 'birth_date': '1947-05-03'},
 {'age': 61, 'birth_date': '1960-06-11'},
 {'age': 99, 'birth_date': '1922-04-03'},
 {'age': 62, 'birth_date': '1958-11-22'},
 {'age': 59, 'birth_date': '1962-06-28'},
 {'age': 67, 'birth_date': '1954-08-17'},
 {'age': 2, 'birth_date': '2019-03-24'},
 {'age': 50, 'birth_date': '1971-07-25'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 3, 'birth_date': '2018-09-20'},
 {'age': 70, 'birth_date': '1951-09-17'},
 {'age': 61, 'birth_date': '1960-06-11'},
 {'age': 62, 'birth_date': '1959-03-18'},
 {'age': 43, 'birth_date': '1978-06-04'},
 {'age': 18, 'birth_date': '2003-10-09'},
 {'age': 71, 'birth_date': '1949-11-25'},
 {'age': 29, 'birth_date': '1992-08-04'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 52, 'birth_date': '1968-11-11'},
 {'age': 71, 'birth_date': '1950-03-23'},
 {'age': 26, 'birth_date': '1995-01-25'},
 {'age': 28, 'birth_date': '1993-10-21'},
 {'age': 56, 'birth_date': '1965-08-30'},
 {'age': 32, 'birth_date': '1989-08-11'},
 {'age': 69, 'birth_date': '1951-12-24'},
 {'age': 23, 'birth_date': '1998-02-14'},
 {'age': 31, 'birth_date': '1990-02-24'},
 {'age': 46, 'birth_date': '1975-03-04'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 106, 'birth_date': '1915-04-02'},
 {'age': 30, 'birth_date': '1991-09-07'},
 {'age': 21, 'birth_date': '2000-10-13'},
 {'age': 67, 'birth_date': '1953-12-24'},
 {'age': 67, 'birth_date': '1954-07-17'},
 {'age': 106, 'birth_date': '1915-04-02'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 106, 'birth_date': '1915-04-02'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 106, 'birth_date': '1915-04-02'},
 {'age': 106, 'birth_date': '1915-04-02'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 106, 'birth_date': '1915-04-02'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 99, 'birth_date': '1922-09-27'},
 {'age': 90, 'birth_date': '1931-03-16'},
 {'age': 90, 'birth_date': '1931-03-16'}]
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># filtering based on age
</span><span class="n">min_age</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">max_age</span> <span class="o">=</span> <span class="mi">79</span>
<span class="n">patients</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="s">'birth_date'</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">'age'</span><span class="p">:</span> <span class="n">get_age</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span> 
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span> <span class="k">if</span> <span class="n">get_age</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">min_age</span> <span class="ow">and</span> <span class="n">get_age</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">max_age</span> <span class="p">]</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">patients</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[{'age': 18, 'birth_date': '2003-04-15'},
 {'age': 55, 'birth_date': '1966-10-02'},
 {'age': 20, 'birth_date': '2001-09-12'},
 {'age': 53, 'birth_date': '1967-11-05'},
 {'age': 23, 'birth_date': '1998-05-27'},
 {'age': 18, 'birth_date': '2003-06-22'},
 {'age': 64, 'birth_date': '1957-02-03'},
 {'age': 39, 'birth_date': '1981-11-24'},
 {'age': 34, 'birth_date': '1987-04-23'},
 {'age': 19, 'birth_date': '2002-05-04'},
 {'age': 18, 'birth_date': '2003-07-13'},
 {'age': 26, 'birth_date': '1995-04-13'},
 {'age': 28, 'birth_date': '1993-08-19'},
 {'age': 29, 'birth_date': '1992-02-09'},
 {'age': 71, 'birth_date': '1950-02-06'},
 {'age': 32, 'birth_date': '1989-05-19'},
 {'age': 41, 'birth_date': '1980-08-01'},
 {'age': 51, 'birth_date': '1970-10-17'},
 {'age': 40, 'birth_date': '1981-09-17'},
 {'age': 53, 'birth_date': '1967-11-06'},
 {'age': 60, 'birth_date': '1961-07-15'},
 {'age': 65, 'birth_date': '1956-04-05'},
 {'age': 21, 'birth_date': '2000-09-13'},
 {'age': 32, 'birth_date': '1989-04-14'},
 {'age': 52, 'birth_date': '1969-08-30'},
 {'age': 52, 'birth_date': '1968-11-10'},
 {'age': 30, 'birth_date': '1991-04-14'},
 {'age': 69, 'birth_date': '1951-12-13'},
 {'age': 24, 'birth_date': '1997-09-25'},
 {'age': 51, 'birth_date': '1970-01-22'},
 {'age': 27, 'birth_date': '1994-10-02'},
 {'age': 76, 'birth_date': '1945-05-24'},
 {'age': 78, 'birth_date': '1943-02-09'},
 {'age': 29, 'birth_date': '1992-01-30'},
 {'age': 69, 'birth_date': '1951-12-13'},
 {'age': 34, 'birth_date': '1987-04-26'},
 {'age': 78, 'birth_date': '1943-02-09'},
 {'age': 58, 'birth_date': '1963-03-09'},
 {'age': 76, 'birth_date': '1945-05-24'},
 {'age': 65, 'birth_date': '1955-11-30'},
 {'age': 70, 'birth_date': '1950-12-18'},
 {'age': 60, 'birth_date': '1961-05-19'},
 {'age': 50, 'birth_date': '1971-07-29'},
 {'age': 32, 'birth_date': '1988-11-14'},
 {'age': 78, 'birth_date': '1943-02-09'},
 {'age': 65, 'birth_date': '1955-11-30'},
 {'age': 48, 'birth_date': '1973-09-21'},
 {'age': 66, 'birth_date': '1955-03-13'},
 {'age': 77, 'birth_date': '1944-05-19'},
 {'age': 25, 'birth_date': '1996-09-26'},
 {'age': 18, 'birth_date': '2002-11-08'},
 {'age': 47, 'birth_date': '1974-11-01'},
 {'age': 79, 'birth_date': '1942-06-19'},
 {'age': 32, 'birth_date': '1989-07-17'},
 {'age': 74, 'birth_date': '1947-05-03'},
 {'age': 61, 'birth_date': '1960-06-11'},
 {'age': 62, 'birth_date': '1958-11-22'},
 {'age': 59, 'birth_date': '1962-06-28'},
 {'age': 67, 'birth_date': '1954-08-17'},
 {'age': 50, 'birth_date': '1971-07-25'},
 {'age': 70, 'birth_date': '1951-09-17'},
 {'age': 61, 'birth_date': '1960-06-11'},
 {'age': 62, 'birth_date': '1959-03-18'},
 {'age': 43, 'birth_date': '1978-06-04'},
 {'age': 18, 'birth_date': '2003-10-09'},
 {'age': 71, 'birth_date': '1949-11-25'},
 {'age': 29, 'birth_date': '1992-08-04'},
 {'age': 52, 'birth_date': '1968-11-11'},
 {'age': 71, 'birth_date': '1950-03-23'},
 {'age': 26, 'birth_date': '1995-01-25'},
 {'age': 28, 'birth_date': '1993-10-21'},
 {'age': 56, 'birth_date': '1965-08-30'},
 {'age': 32, 'birth_date': '1989-08-11'},
 {'age': 69, 'birth_date': '1951-12-24'},
 {'age': 23, 'birth_date': '1998-02-14'},
 {'age': 31, 'birth_date': '1990-02-24'},
 {'age': 46, 'birth_date': '1975-03-04'},
 {'age': 30, 'birth_date': '1991-09-07'},
 {'age': 21, 'birth_date': '2000-10-13'},
 {'age': 67, 'birth_date': '1953-12-24'},
 {'age': 67, 'birth_date': '1954-07-17'}]
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># another way to do it, add the age to the end
</span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="n">row</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_age</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['3287bb9c-e395-4146-8dd5-1fc3d887d220', '2015-07-12', '', '999-82-9751', '', '', '', 'Victor265', 'Kilback373', '', '', '', 'white', 'polish', 'M', 'Newton  Massachusetts  US', '657 Heathcote Divide', 'Fitchburg', 'Massachusetts', '01420', 6]
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">min_age</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">max_age</span> <span class="o">=</span> <span class="mi">79</span>
<span class="n">patients</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="s">'birth_date'</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">'age'</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span> 
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_age</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_age</span> <span class="p">]</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">patients</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[{'age': 18, 'birth_date': '2003-04-15'},
 {'age': 55, 'birth_date': '1966-10-02'},
 {'age': 20, 'birth_date': '2001-09-12'},
 {'age': 53, 'birth_date': '1967-11-05'},
 {'age': 23, 'birth_date': '1998-05-27'},
 {'age': 18, 'birth_date': '2003-06-22'},
 {'age': 64, 'birth_date': '1957-02-03'},
 {'age': 39, 'birth_date': '1981-11-24'},
 {'age': 34, 'birth_date': '1987-04-23'},
 {'age': 19, 'birth_date': '2002-05-04'},
 {'age': 18, 'birth_date': '2003-07-13'},
 {'age': 26, 'birth_date': '1995-04-13'},
 {'age': 28, 'birth_date': '1993-08-19'},
 {'age': 29, 'birth_date': '1992-02-09'},
 {'age': 71, 'birth_date': '1950-02-06'},
 {'age': 32, 'birth_date': '1989-05-19'},
 {'age': 41, 'birth_date': '1980-08-01'},
 {'age': 51, 'birth_date': '1970-10-17'},
 {'age': 40, 'birth_date': '1981-09-17'},
 {'age': 53, 'birth_date': '1967-11-06'},
 {'age': 60, 'birth_date': '1961-07-15'},
 {'age': 65, 'birth_date': '1956-04-05'},
 {'age': 21, 'birth_date': '2000-09-13'},
 {'age': 32, 'birth_date': '1989-04-14'},
 {'age': 52, 'birth_date': '1969-08-30'},
 {'age': 52, 'birth_date': '1968-11-10'},
 {'age': 30, 'birth_date': '1991-04-14'},
 {'age': 69, 'birth_date': '1951-12-13'},
 {'age': 24, 'birth_date': '1997-09-25'},
 {'age': 51, 'birth_date': '1970-01-22'},
 {'age': 27, 'birth_date': '1994-10-02'},
 {'age': 76, 'birth_date': '1945-05-24'},
 {'age': 78, 'birth_date': '1943-02-09'},
 {'age': 29, 'birth_date': '1992-01-30'},
 {'age': 69, 'birth_date': '1951-12-13'},
 {'age': 34, 'birth_date': '1987-04-26'},
 {'age': 78, 'birth_date': '1943-02-09'},
 {'age': 58, 'birth_date': '1963-03-09'},
 {'age': 76, 'birth_date': '1945-05-24'},
 {'age': 65, 'birth_date': '1955-11-30'},
 {'age': 70, 'birth_date': '1950-12-18'},
 {'age': 60, 'birth_date': '1961-05-19'},
 {'age': 50, 'birth_date': '1971-07-29'},
 {'age': 32, 'birth_date': '1988-11-14'},
 {'age': 78, 'birth_date': '1943-02-09'},
 {'age': 65, 'birth_date': '1955-11-30'},
 {'age': 48, 'birth_date': '1973-09-21'},
 {'age': 66, 'birth_date': '1955-03-13'},
 {'age': 77, 'birth_date': '1944-05-19'},
 {'age': 25, 'birth_date': '1996-09-26'},
 {'age': 18, 'birth_date': '2002-11-08'},
 {'age': 47, 'birth_date': '1974-11-01'},
 {'age': 79, 'birth_date': '1942-06-19'},
 {'age': 32, 'birth_date': '1989-07-17'},
 {'age': 74, 'birth_date': '1947-05-03'},
 {'age': 61, 'birth_date': '1960-06-11'},
 {'age': 62, 'birth_date': '1958-11-22'},
 {'age': 59, 'birth_date': '1962-06-28'},
 {'age': 67, 'birth_date': '1954-08-17'},
 {'age': 50, 'birth_date': '1971-07-25'},
 {'age': 70, 'birth_date': '1951-09-17'},
 {'age': 61, 'birth_date': '1960-06-11'},
 {'age': 62, 'birth_date': '1959-03-18'},
 {'age': 43, 'birth_date': '1978-06-04'},
 {'age': 18, 'birth_date': '2003-10-09'},
 {'age': 71, 'birth_date': '1949-11-25'},
 {'age': 29, 'birth_date': '1992-08-04'},
 {'age': 52, 'birth_date': '1968-11-11'},
 {'age': 71, 'birth_date': '1950-03-23'},
 {'age': 26, 'birth_date': '1995-01-25'},
 {'age': 28, 'birth_date': '1993-10-21'},
 {'age': 56, 'birth_date': '1965-08-30'},
 {'age': 32, 'birth_date': '1989-08-11'},
 {'age': 69, 'birth_date': '1951-12-24'},
 {'age': 23, 'birth_date': '1998-02-14'},
 {'age': 31, 'birth_date': '1990-02-24'},
 {'age': 46, 'birth_date': '1975-03-04'},
 {'age': 30, 'birth_date': '1991-09-07'},
 {'age': 21, 'birth_date': '2000-10-13'},
 {'age': 67, 'birth_date': '1953-12-24'},
 {'age': 67, 'birth_date': '1954-07-17'}]
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># todo we might want to shift all dates (e.g. birthday, encounter date)
</span></code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fake_names</span> <span class="o">=</span> <span class="s">'''Veronique Tippetts
Sarah Santiago
Eustolia Bushard
Emanuel Riker
Maybelle Denney
Lilia Gobel
Clarine Vandermeer
Felicidad Joynes
Rod Pixley
Rashad Fukushima
Marci Bakley
Melvina Cichon
Susy Sibert
Oma Hoskins
Lance Curnutte
Mei Wooldridge
Jillian Mccroy
Darby Castellon
Raul Pickney
Loni Kaur'''</span>
<span class="k">print</span><span class="p">(</span><span class="n">fake_names</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Veronique Tippetts
Sarah Santiago
Eustolia Bushard
Emanuel Riker
Maybelle Denney
Lilia Gobel
Clarine Vandermeer
Felicidad Joynes
Rod Pixley
Rashad Fukushima
Marci Bakley
Melvina Cichon
Susy Sibert
Oma Hoskins
Lance Curnutte
Mei Wooldridge
Jillian Mccroy
Darby Castellon
Raul Pickney
Loni Kaur
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fake_names</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['Veronique Tippetts',
 'Sarah Santiago',
 'Eustolia Bushard',
 'Emanuel Riker',
 'Maybelle Denney',
 'Lilia Gobel',
 'Clarine Vandermeer',
 'Felicidad Joynes',
 'Rod Pixley',
 'Rashad Fukushima',
 'Marci Bakley',
 'Melvina Cichon',
 'Susy Sibert',
 'Oma Hoskins',
 'Lance Curnutte',
 'Mei Wooldridge',
 'Jillian Mccroy',
 'Darby Castellon',
 'Raul Pickney',
 'Loni Kaur']
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># deidentify the name
</span><span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">fake_name_generator</span><span class="p">():</span>
    <span class="n">fake_names</span> <span class="o">=</span> \
<span class="s">"""Veronique Tippetts
Sarah Santiago
Eustolia Bushard
Emanuel Riker
Maybelle Denney
Lilia Gobel
Clarine Vandermeer
Felicidad Joynes
Rod Pixley
Rashad Fukushima
Marci Bakley
Melvina Cichon
Susy Sibert
Oma Hoskins
Lance Curnutte
Mei Wooldridge
Jillian Mccroy
Darby Castellon
Raul Pickney
Loni Kaur"""</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">fake_names</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">fake_name_generator</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">fake_name_generator</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">fake_name_generator</span><span class="p">())</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Lance Curnutte
Darby Castellon
Loni Kaur
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># don't reuse names
</span><span class="n">fake_names</span> <span class="o">=</span> \
<span class="s">"""Veronique Tippetts
Sarah Santiago
Eustolia Bushard
Emanuel Riker
Maybelle Denney
Lilia Gobel
Clarine Vandermeer
Felicidad Joynes
Rod Pixley
Rashad Fukushima
Marci Bakley
Melvina Cichon
Susy Sibert
Oma Hoskins
Lance Curnutte
Mei Wooldridge
Jillian Mccroy
Darby Castellon
Raul Pickney
Loni Kaur"""</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">get_fake_name</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fake_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fake_names</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">fake_names</span><span class="p">[</span><span class="n">r</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">del</span> <span class="n">fake_names</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">n</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">get_fake_name</span><span class="p">())</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rashad Fukushima
Raul Pickney
Marci Bakley
Melvina Cichon
Mei Wooldridge
Maybelle Denney
Emanuel Riker
Veronique Tippetts
Rod Pixley
Lance Curnutte
Susy Sibert
Loni Kaur
Sarah Santiago
Clarine Vandermeer
Jillian Mccroy
Felicidad Joynes
Darby Castellon
Oma Hoskins
Eustolia Bushard
Lilia Gobel
None
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">min_age</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">max_age</span> <span class="o">=</span> <span class="mi">79</span>
<span class="n">patients</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="s">'birth_date'</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">'age'</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="s">'name'</span><span class="p">:</span> <span class="n">get_fake_name</span><span class="p">()</span> <span class="p">}</span> 
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_age</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_age</span> <span class="p">]</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">patients</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[{'age': 18, 'birth_date': '2003-04-15', 'name': None},
 {'age': 55, 'birth_date': '1966-10-02', 'name': None},
 {'age': 20, 'birth_date': '2001-09-12', 'name': None},
 {'age': 53, 'birth_date': '1967-11-05', 'name': None},
 {'age': 23, 'birth_date': '1998-05-27', 'name': None},
 {'age': 18, 'birth_date': '2003-06-22', 'name': None},
 {'age': 64, 'birth_date': '1957-02-03', 'name': None},
 {'age': 39, 'birth_date': '1981-11-24', 'name': None},
 {'age': 34, 'birth_date': '1987-04-23', 'name': None},
 {'age': 19, 'birth_date': '2002-05-04', 'name': None},
 {'age': 18, 'birth_date': '2003-07-13', 'name': None},
 {'age': 26, 'birth_date': '1995-04-13', 'name': None},
 {'age': 28, 'birth_date': '1993-08-19', 'name': None},
 {'age': 29, 'birth_date': '1992-02-09', 'name': None},
 {'age': 71, 'birth_date': '1950-02-06', 'name': None},
 {'age': 32, 'birth_date': '1989-05-19', 'name': None},
 {'age': 41, 'birth_date': '1980-08-01', 'name': None},
 {'age': 51, 'birth_date': '1970-10-17', 'name': None},
 {'age': 40, 'birth_date': '1981-09-17', 'name': None},
 {'age': 53, 'birth_date': '1967-11-06', 'name': None},
 {'age': 60, 'birth_date': '1961-07-15', 'name': None},
 {'age': 65, 'birth_date': '1956-04-05', 'name': None},
 {'age': 21, 'birth_date': '2000-09-13', 'name': None},
 {'age': 32, 'birth_date': '1989-04-14', 'name': None},
 {'age': 52, 'birth_date': '1969-08-30', 'name': None},
 {'age': 52, 'birth_date': '1968-11-10', 'name': None},
 {'age': 30, 'birth_date': '1991-04-14', 'name': None},
 {'age': 69, 'birth_date': '1951-12-13', 'name': None},
 {'age': 24, 'birth_date': '1997-09-25', 'name': None},
 {'age': 51, 'birth_date': '1970-01-22', 'name': None},
 {'age': 27, 'birth_date': '1994-10-02', 'name': None},
 {'age': 76, 'birth_date': '1945-05-24', 'name': None},
 {'age': 78, 'birth_date': '1943-02-09', 'name': None},
 {'age': 29, 'birth_date': '1992-01-30', 'name': None},
 {'age': 69, 'birth_date': '1951-12-13', 'name': None},
 {'age': 34, 'birth_date': '1987-04-26', 'name': None},
 {'age': 78, 'birth_date': '1943-02-09', 'name': None},
 {'age': 58, 'birth_date': '1963-03-09', 'name': None},
 {'age': 76, 'birth_date': '1945-05-24', 'name': None},
 {'age': 65, 'birth_date': '1955-11-30', 'name': None},
 {'age': 70, 'birth_date': '1950-12-18', 'name': None},
 {'age': 60, 'birth_date': '1961-05-19', 'name': None},
 {'age': 50, 'birth_date': '1971-07-29', 'name': None},
 {'age': 32, 'birth_date': '1988-11-14', 'name': None},
 {'age': 78, 'birth_date': '1943-02-09', 'name': None},
 {'age': 65, 'birth_date': '1955-11-30', 'name': None},
 {'age': 48, 'birth_date': '1973-09-21', 'name': None},
 {'age': 66, 'birth_date': '1955-03-13', 'name': None},
 {'age': 77, 'birth_date': '1944-05-19', 'name': None},
 {'age': 25, 'birth_date': '1996-09-26', 'name': None},
 {'age': 18, 'birth_date': '2002-11-08', 'name': None},
 {'age': 47, 'birth_date': '1974-11-01', 'name': None},
 {'age': 79, 'birth_date': '1942-06-19', 'name': None},
 {'age': 32, 'birth_date': '1989-07-17', 'name': None},
 {'age': 74, 'birth_date': '1947-05-03', 'name': None},
 {'age': 61, 'birth_date': '1960-06-11', 'name': None},
 {'age': 62, 'birth_date': '1958-11-22', 'name': None},
 {'age': 59, 'birth_date': '1962-06-28', 'name': None},
 {'age': 67, 'birth_date': '1954-08-17', 'name': None},
 {'age': 50, 'birth_date': '1971-07-25', 'name': None},
 {'age': 70, 'birth_date': '1951-09-17', 'name': None},
 {'age': 61, 'birth_date': '1960-06-11', 'name': None},
 {'age': 62, 'birth_date': '1959-03-18', 'name': None},
 {'age': 43, 'birth_date': '1978-06-04', 'name': None},
 {'age': 18, 'birth_date': '2003-10-09', 'name': None},
 {'age': 71, 'birth_date': '1949-11-25', 'name': None},
 {'age': 29, 'birth_date': '1992-08-04', 'name': None},
 {'age': 52, 'birth_date': '1968-11-11', 'name': None},
 {'age': 71, 'birth_date': '1950-03-23', 'name': None},
 {'age': 26, 'birth_date': '1995-01-25', 'name': None},
 {'age': 28, 'birth_date': '1993-10-21', 'name': None},
 {'age': 56, 'birth_date': '1965-08-30', 'name': None},
 {'age': 32, 'birth_date': '1989-08-11', 'name': None},
 {'age': 69, 'birth_date': '1951-12-24', 'name': None},
 {'age': 23, 'birth_date': '1998-02-14', 'name': None},
 {'age': 31, 'birth_date': '1990-02-24', 'name': None},
 {'age': 46, 'birth_date': '1975-03-04', 'name': None},
 {'age': 30, 'birth_date': '1991-09-07', 'name': None},
 {'age': 21, 'birth_date': '2000-10-13', 'name': None},
 {'age': 67, 'birth_date': '1953-12-24', 'name': None},
 {'age': 67, 'birth_date': '1954-07-17', 'name': None}]
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div> </div> </div> </div> </body> </html>
